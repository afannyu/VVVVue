{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, vShow as _vShow, withDirectives as _withDirectives, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-10093974\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"order\"\n};\nconst _hoisted_2 = {\n  class: \"order__price\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\"实付金额：\");\n\nconst _hoisted_4 = {\n  class: \"mask\"\n};\nconst _hoisted_5 = {\n  class: \"mask__content\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"h3\", null, \"确认要离开收银台？\", -1\n/* HOISTED */\n));\n\nconst _hoisted_7 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  class: \"mask__content__desc\"\n}, \"请尽快完成支付，否则将被取消\", -1\n/* HOISTED */\n));\n\nconst _hoisted_8 = {\n  class: \"mask__content__btns\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_hoisted_3, _createElementVNode(\"b\", null, \"￥\" + _toDisplayString($setup.caculations.price), 1\n  /* TEXT */\n  )]), _createElementVNode(\"div\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $setup.handleOrderClick && $setup.handleOrderClick(...args)),\n    class: \"order__order\"\n  }, \"提交订单\")]), _withDirectives(_createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _hoisted_7, _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", {\n    onClick: _cache[1] || (_cache[1] = () => $setup.handleComfirmClick(true)),\n    class: \"mask__content__btn\"\n  }, \"取消订单\"), _createElementVNode(\"div\", {\n    onClick: _cache[2] || (_cache[2] = () => $setup.handleComfirmClick(false)),\n    class: \"mask__content__btn\"\n  }, \"确认支付\")])])], 512\n  /* NEED_PATCH */\n  ), [[_vShow, $setup.showBtn]])], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":";;;;;EACKA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;iDAAe;;;EAMvBA,KAAK,EAAC;;;EACJA,KAAK,EAAC;;;gEACTC,oBAAkB,IAAlB,EAAkB,IAAlB,EAAI,WAAJ,EAAa;AAAA;AAAb;;gEACAA,oBAAqD,KAArD,EAAqD;EAAhDD,KAAK,EAAC;AAA0C,CAArD,EAAiC,gBAAjC,EAA+C;AAAA;AAA/C;;;EACKA,KAAK,EAAC;;;6DAXfC,oBAMM,KANN,cAMM,CALJA,oBAAmE,KAAnE,cAAmE,aAApCA,oBAA8B,GAA9B,EAA8B,IAA9B,EAAG,MAACC,iBAAGC,mBAAYC,KAAf,CAAJ,EAAwB;EAAA;EAAxB,CAAoC,CAAnE,CAKI,EAJJH,oBAGW,KAHX,EAGW;IAFVI,OAAK,yCAAEF,2DAAF,CAEK;IADXH,KAAK,EAAC;EACK,CAHX,EAGC,MAHD,CAII,CANN,mBAOAC,oBAeM,KAfN,cAeM,CAdJA,oBAaM,KAbN,cAaM,CAZJK,UAYI,EAXJC,UAWI,EAVJN,oBASM,KATN,cASM,CARJA,oBAGW,KAHX,EAGW;IAFVI,OAAK,kCAAMF,0BAAkB,IAAlB,CAAN,CAEK;IADXH,KAAK,EAAC;EACK,CAHX,EAGC,MAHD,CAQI,EAJJC,oBAGW,KAHX,EAGW;IAFVI,OAAK,kCAAMF,0BAAkB,KAAlB,CAAN,CAEK;IADXH,KAAK,EAAC;EACK,CAHX,EAGC,MAHD,CAII,CATN,CAUI,CAbN,CAcI,CAfN;;EAAA,aAA0BG","names":["class","_createElementVNode","_toDisplayString","$setup","price","onClick","_hoisted_6","_hoisted_7"],"sourceRoot":"","sources":["C:\\Carrie\\VVVVVue\\jingdong\\src\\views\\order\\Bottom.vue"],"sourcesContent":["<template>\r\n<div class=\"order\">\r\n  <div class=\"order__price\">实付金额：<b>￥{{ caculations.price}}</b></div>\r\n  <div\r\n  @click=\"handleOrderClick\"\r\n  class=\"order__order\"\r\n  >提交订单</div>\r\n</div>\r\n<div class=\"mask\" v-show=\"showBtn\">\r\n  <div class=\"mask__content\">\r\n    <h3>确认要离开收银台？</h3>\r\n    <div class=\"mask__content__desc\">请尽快完成支付，否则将被取消</div>\r\n    <div class=\"mask__content__btns\">\r\n      <div\r\n      @click=\"()=>handleComfirmClick(true)\"\r\n      class=\"mask__content__btn\"\r\n      >取消订单</div>\r\n      <div\r\n      @click=\"()=>handleComfirmClick(false)\"\r\n      class=\"mask__content__btn\"\r\n      >确认支付</div>\r\n    </div>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router';\r\nimport { commonCartEffect  } from '@/effects/cartEffects';\r\nimport { ref } from '@vue/reactivity';\r\nimport { post } from '@/utils/request';\r\nimport router from '@/router';\r\nimport { useStore } from 'vuex';\r\n\r\nconst store = useStore()\r\nconst useClickEffect = (shopId, shopName, productList)=>{\r\n  const showBtn = ref(false)\r\n  const handleOrderClick = ()=>{\r\n    showBtn.value = !showBtn.value\r\n  }\r\n\r\n  const handleComfirmClick = async(isCanceled)=>{\r\n    // 点击确认支付，向接口发送数据，满足接口所需要的数据结构\r\n    // 假如成功的话，就跳转页面\r\n    const products = []\r\n    for(let i in productList.value) {\r\n      let product = productList.value[i]\r\n      products.push({\r\n        id: parseInt(product._id, 10),\r\n        num: product.count\r\n      })\r\n      console.log(product)\r\n    }\r\n    try {\r\n      const result = await post('/api/order',{\r\n        addressId: 1,\r\n        shopId: parseInt(shopId, 10),\r\n        shopName: shopName.value,\r\n        isCanceled: isCanceled,\r\n        products: products\r\n      })\r\n      // console.log(result)\r\n      if(result?.errno === 0) {\r\n        store.commit('clearCartProducts',shopId)\r\n        router.push({name: 'Home'})\r\n      }\r\n    }catch(e){\r\n      console.log('请求失败')\r\n    }\r\n  }\r\n  return {\r\n     handleComfirmClick,\r\n     showBtn, handleOrderClick\r\n  }\r\n}\r\nexport default {\r\n  name: 'BottomView',\r\n  setup() {\r\n    const route = useRoute();\r\n    const shopId = route.params.id;\r\n    const { caculations, shopName, productList } = commonCartEffect(shopId);\r\n    const { handleComfirmClick, showBtn, handleOrderClick } = useClickEffect(shopId, shopName, productList)\r\n    return {\r\n        caculations,\r\n        handleComfirmClick, showBtn,\r\n        handleOrderClick\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/viriables.scss';\r\n\r\n.order {\r\n  position: absolute;\r\n  display: flex;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  line-height: .49rem;\r\n  height: .49rem;\r\n  background: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    line-height: .49rem;\r\n    font-size: .14rem;\r\n    text-indent: .24rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__order {\r\n    width: .98rem;\r\n    background: $btn-bgColor;\r\n    color: $bgColor;\r\n    font-size: .14rem;\r\n    text-align: center;\r\n  }\r\n}\r\n\r\n.mask {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, .5);\r\n  z-index: 1;\r\n  &__content {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background: $bgColor;\r\n    height: 1.52rem;\r\n    width: 2.97rem;\r\n    border-radius: 4px;\r\n    text-align: center;\r\n    h3 {\r\n      margin: .24rem auto 0 auto;\r\n      line-height: .25rem;\r\n      font-size: .18rem;\r\n    }\r\n    &__desc {\r\n      margin: .08rem auto .19rem auto;\r\n      line-height: .2rem;\r\n      font-size: .14rem;\r\n      color: $mid-fontColor;\r\n    }\r\n    &__btns {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n    }\r\n    &__btn {\r\n      height: .32rem;\r\n      width: .8rem;\r\n      line-height: .31rem;\r\n      font-size: .14rem;\r\n      text-align: center;\r\n      border-radius: 16px;\r\n    }\r\n    &__btn:nth-child(1) {\r\n      border: 1px solid #4FB0F9;\r\n      color: $btn-bgColor;\r\n    }\r\n    &__btn:nth-child(2) {\r\n      margin-left: .24rem;\r\n      background: #4FB0F9;\r\n      border: 1px solid #4FB0F9;\r\n      color: white;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}