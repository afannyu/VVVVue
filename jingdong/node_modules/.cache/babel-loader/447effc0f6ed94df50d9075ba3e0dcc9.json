{"ast":null,"code":"import { useRoute } from 'vue-router';\nimport { commonCartEffect } from '@/effects/cartEffects';\nimport { ref } from '@vue/reactivity';\nimport { post } from '@/utils/request';\n\nconst useClickEffect = (shopId, shopName, productList) => {\n  console.log(productList);\n  const showBtn = ref(false);\n\n  const handleOrderClick = () => {\n    showBtn.value = !showBtn.value;\n  };\n\n  const handleCancelClick = () => {\n    showBtn.value = !showBtn.value;\n  };\n\n  const handleComfirmClick = async () => {\n    const products = [];\n\n    for (let i in productList) {\n      let product = productList[i];\n      products.push({\n        id: product._id,\n        num: product.count\n      });\n    }\n\n    console.log(products);\n\n    try {\n      const result = await post('/api/order', {\n        addressId: 1,\n        shopId,\n        shopName: shopName.value,\n        isCanceled: false,\n        products: {}\n      });\n      console.log(result);\n    } catch (e) {\n      console.log('请求失败');\n    }\n  };\n\n  return {\n    handleCancelClick,\n    handleComfirmClick,\n    showBtn,\n    handleOrderClick\n  };\n};\n\nexport default {\n  name: 'BottomView',\n\n  setup() {\n    const route = useRoute();\n    const shopId = route.params.id;\n    const {\n      caculations,\n      shopName,\n      productList\n    } = commonCartEffect(shopId);\n    const {\n      handleCancelClick,\n      handleComfirmClick,\n      showBtn,\n      handleOrderClick\n    } = useClickEffect(shopId, shopName, productList);\n    return {\n      caculations,\n      handleCancelClick,\n      handleComfirmClick,\n      showBtn,\n      handleOrderClick\n    };\n  }\n\n};","map":{"version":3,"mappings":"AA2BA,SAASA,QAAT,QAAyB,YAAzB;AACA,SAASC,gBAAT,QAAkC,uBAAlC;AACA,SAASC,GAAT,QAAoB,iBAApB;AACA,SAASC,IAAT,QAAqB,iBAArB;;AAEA,MAAMC,cAAa,GAAI,CAACC,MAAD,EAASC,QAAT,EAAmBC,WAAnB,KAAiC;EACtDC,OAAO,CAACC,GAAR,CAAYF,WAAZ;EACA,MAAMG,OAAM,GAAIR,GAAG,CAAC,KAAD,CAAnB;;EACA,MAAMS,gBAAe,GAAI,MAAI;IAC3BD,OAAO,CAACE,KAAR,GAAgB,CAACF,OAAO,CAACE,KAAzB;EACF,CAFA;;EAGA,MAAMC,iBAAgB,GAAI,MAAI;IAC5BH,OAAO,CAACE,KAAR,GAAgB,CAACF,OAAO,CAACE,KAAzB;EACF,CAFA;;EAGA,MAAME,kBAAiB,GAAI,YAAS;IAClC,MAAMC,QAAO,GAAI,EAAjB;;IACA,KAAI,IAAIC,CAAR,IAAaT,WAAb,EAA0B;MACxB,IAAIU,OAAM,GAAIV,WAAW,CAACS,CAAD,CAAzB;MACAD,QAAQ,CAACG,IAAT,CAAc;QACZC,EAAE,EAAEF,OAAO,CAACG,GADA;QAEZC,GAAG,EAAEJ,OAAO,CAACK;MAFD,CAAd;IAIF;;IACAd,OAAO,CAACC,GAAR,CAAYM,QAAZ;;IACA,IAAI;MACF,MAAMQ,MAAK,GAAI,MAAMpB,IAAI,CAAC,YAAD,EAAc;QACrCqB,SAAS,EAAE,CAD0B;QAErCnB,MAFqC;QAGrCC,QAAQ,EAAEA,QAAQ,CAACM,KAHkB;QAIrCa,UAAU,EAAE,KAJyB;QAKrCV,QAAQ,EAAE;MAL2B,CAAd,CAAzB;MASAP,OAAO,CAACC,GAAR,CAAYc,MAAZ;IACD,CAXD,CAWC,OAAMG,CAAN,EAAQ;MACPlB,OAAO,CAACC,GAAR,CAAY,MAAZ;IACF;EACF,CAxBA;;EAyBA,OAAO;IACLI,iBADK;IACcC,kBADd;IAEJJ,OAFI;IAEKC;EAFL,CAAP;AAIF,CAtCA;;AAuCA,eAAe;EACbgB,IAAI,EAAE,YADO;;EAEbC,KAAK,GAAG;IACN,MAAMC,KAAI,GAAI7B,QAAQ,EAAtB;IACA,MAAMK,MAAK,GAAIwB,KAAK,CAACC,MAAN,CAAaX,EAA5B;IACA,MAAM;MAAEY,WAAF;MAAezB,QAAf;MAAyBC;IAAzB,IAAyCN,gBAAgB,CAACI,MAAD,CAA/D;IACA,MAAM;MAAEQ,iBAAF;MAAqBC,kBAArB;MACLJ,OADK;MACIC;IADJ,IACyBP,cAAc,CAACC,MAAD,EAASC,QAAT,EAAmBC,WAAnB,CAD7C;IAEA,OAAO;MACHwB,WADG;MACUlB,iBADV;MAEHC,kBAFG;MAEiBJ,OAFjB;MAGHC;IAHG,CAAP;EAKF;;AAba,CAAf","names":["useRoute","commonCartEffect","ref","post","useClickEffect","shopId","shopName","productList","console","log","showBtn","handleOrderClick","value","handleCancelClick","handleComfirmClick","products","i","product","push","id","_id","num","count","result","addressId","isCanceled","e","name","setup","route","params","caculations"],"sourceRoot":"","sources":["C:\\Carrie\\VVVVVue\\jingdong\\src\\views\\order\\Bottom.vue"],"sourcesContent":["<template>\r\n<div class=\"order\">\r\n  <div class=\"order__price\">实付金额：<b>￥{{ caculations.price}}</b></div>\r\n  <div\r\n  @click=\"handleOrderClick\"\r\n  class=\"order__order\"\r\n  >提交订单</div>\r\n</div>\r\n<div class=\"mask\" v-show=\"showBtn\">\r\n  <div class=\"mask__content\">\r\n    <h3>确认要离开收银台？</h3>\r\n    <div class=\"mask__content__desc\">请尽快完成支付，否则将被取消</div>\r\n    <div class=\"mask__content__btns\">\r\n      <div\r\n      @click=\"handleCancelClick\"\r\n      class=\"mask__content__btn\"\r\n      >取消订单</div>\r\n      <div\r\n      @click=\"handleComfirmClick\"\r\n      class=\"mask__content__btn\"\r\n      >确认支付</div>\r\n    </div>\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport { useRoute } from 'vue-router';\r\nimport { commonCartEffect  } from '@/effects/cartEffects';\r\nimport { ref } from '@vue/reactivity';\r\nimport { post } from '@/utils/request';\r\n\r\nconst useClickEffect = (shopId, shopName, productList)=>{\r\n  console.log(productList)\r\n  const showBtn = ref(false)\r\n  const handleOrderClick = ()=>{\r\n    showBtn.value = !showBtn.value\r\n  }\r\n  const handleCancelClick = ()=>{\r\n    showBtn.value = !showBtn.value\r\n  }\r\n  const handleComfirmClick = async()=>{\r\n    const products = []\r\n    for(let i in productList) {\r\n      let product = productList[i]\r\n      products.push({\r\n        id: product._id,\r\n        num: product.count\r\n      })\r\n    }\r\n    console.log(products)\r\n    try {\r\n      const result = await post('/api/order',{\r\n        addressId: 1,\r\n        shopId,\r\n        shopName: shopName.value,\r\n        isCanceled: false,\r\n        products: {\r\n\r\n        }\r\n      })\r\n      console.log(result)\r\n    }catch(e){\r\n      console.log('请求失败')\r\n    }\r\n  }\r\n  return {\r\n    handleCancelClick, handleComfirmClick,\r\n     showBtn, handleOrderClick\r\n  }\r\n}\r\nexport default {\r\n  name: 'BottomView',\r\n  setup() {\r\n    const route = useRoute();\r\n    const shopId = route.params.id;\r\n    const { caculations, shopName, productList } = commonCartEffect(shopId);\r\n    const { handleCancelClick, handleComfirmClick,\r\n     showBtn, handleOrderClick } = useClickEffect(shopId, shopName, productList)\r\n    return {\r\n        caculations, handleCancelClick,\r\n        handleComfirmClick, showBtn,\r\n        handleOrderClick\r\n    };\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import '../../style/viriables.scss';\r\n\r\n.order {\r\n  position: absolute;\r\n  display: flex;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  line-height: .49rem;\r\n  height: .49rem;\r\n  background: $bgColor;\r\n  &__price {\r\n    flex: 1;\r\n    line-height: .49rem;\r\n    font-size: .14rem;\r\n    text-indent: .24rem;\r\n    color: $content-fontcolor;\r\n  }\r\n  &__order {\r\n    width: .98rem;\r\n    background: $btn-bgColor;\r\n    color: $bgColor;\r\n    font-size: .14rem;\r\n    text-align: center;\r\n  }\r\n}\r\n\r\n.mask {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n  background: rgba(0, 0, 0, .5);\r\n  z-index: 1;\r\n  &__content {\r\n    position: absolute;\r\n    top: 50%;\r\n    left: 50%;\r\n    transform: translate(-50%, -50%);\r\n    background: $bgColor;\r\n    height: 1.52rem;\r\n    width: 2.97rem;\r\n    border-radius: 4px;\r\n    text-align: center;\r\n    h3 {\r\n      margin: .24rem auto 0 auto;\r\n      line-height: .25rem;\r\n      font-size: .18rem;\r\n    }\r\n    &__desc {\r\n      margin: .08rem auto .19rem auto;\r\n      line-height: .2rem;\r\n      font-size: .14rem;\r\n      color: $mid-fontColor;\r\n    }\r\n    &__btns {\r\n      display: flex;\r\n      justify-content: center;\r\n      align-items: center;\r\n    }\r\n    &__btn {\r\n      height: .32rem;\r\n      width: .8rem;\r\n      line-height: .31rem;\r\n      font-size: .14rem;\r\n      text-align: center;\r\n      border-radius: 16px;\r\n    }\r\n    &__btn:nth-child(1) {\r\n      border: 1px solid #4FB0F9;\r\n      color: $btn-bgColor;\r\n    }\r\n    &__btn:nth-child(2) {\r\n      margin-left: .24rem;\r\n      background: #4FB0F9;\r\n      border: 1px solid #4FB0F9;\r\n      color: white;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}