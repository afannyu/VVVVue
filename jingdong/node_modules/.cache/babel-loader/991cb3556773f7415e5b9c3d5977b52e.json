{"ast":null,"code":"import { reactive, toRefs } from \"@vue/reactivity\";\nimport { useRouter } from \"vue-router\";\nimport { post } from \"@/utils/request\";\nimport Toast, { useToastEffect } from \"@/components/Toast.vue\"; // 将注册的逻辑摘离出来\n\nconst useRegisterEffect = showToast => {\n  const router = useRouter();\n  const data = reactive({\n    username: \"\",\n    password: \"\",\n    password2: \"\"\n  });\n  const {\n    username,\n    password,\n    password2\n  } = toRefs(data);\n\n  const handleRegister = async () => {\n    try {\n      const result = await post(\"/api/user/register\", {\n        username: data.username,\n        password: data.password,\n        password2: data.password2\n      });\n\n      if (result?.Error === 0) {\n        localStorage.isLogin = true;\n        router.push({\n          name: \"Home\"\n        });\n      } else {\n        showToast(\"注册失败\");\n      }\n    } catch (e) {\n      showToast(\"请求失败\");\n    }\n  };\n\n  return {\n    handleRegister,\n    username,\n    password,\n    password2\n  };\n};\n\nconst useLoginEffect = () => {\n  const router = useRouter();\n\n  const handleHave = () => {\n    router.push({\n      name: \"Login\"\n    });\n  };\n\n  return {\n    handleHave\n  };\n};\n\nexport default {\n  name: \"RegisterView\",\n\n  setup() {\n    const {\n      show,\n      toastMsg,\n      showToast\n    } = useToastEffect();\n    const {\n      handleRegister,\n      username,\n      password,\n      password2\n    } = useRegisterEffect(showToast);\n    const {\n      handleHave\n    } = useLoginEffect();\n    return {\n      handleHave,\n      username,\n      password,\n      password2,\n      handleRegister,\n      show,\n      toastMsg\n    };\n  },\n\n  components: {\n    Toast\n  }\n};","map":{"version":3,"mappings":"AAmBA,SAASA,QAAT,EAAkBC,MAAlB,QAAgC,iBAAhC;AACA,SAASC,SAAT,QAA0B,YAA1B;AACA,SAASC,IAAT,QAAqB,iBAArB;AACA,OAAOC,KAAP,IAAgBC,cAAhB,QAAsC,wBAAtC,C,CAEA;;AACA,MAAMC,iBAAgB,GAAKC,SAAD,IAAa;EACrC,MAAMC,MAAK,GAAIN,SAAS,EAAxB;EACA,MAAMO,IAAG,GAAIT,QAAQ,CAAC;IACpBU,QAAQ,EAAE,EADU;IAEpBC,QAAQ,EAAE,EAFU;IAGpBC,SAAS,EAAE;EAHS,CAAD,CAArB;EAKA,MAAM;IAACF,QAAD;IAAWC,QAAX;IAAqBC;EAArB,IAAkCX,MAAM,CAACQ,IAAD,CAA9C;;EACA,MAAMI,cAAa,GAAI,YAAY;IACjC,IAAI;MACF,MAAMC,MAAK,GAAI,MAAMX,IAAI,CAAC,oBAAD,EAAuB;QAC9CO,QAAQ,EAAED,IAAI,CAACC,QAD+B;QAE9CC,QAAQ,EAAEF,IAAI,CAACE,QAF+B;QAG9CC,SAAS,EAAEH,IAAI,CAACG;MAH8B,CAAvB,CAAzB;;MAKA,IAAIE,MAAM,EAAEC,KAAR,KAAkB,CAAtB,EAAyB;QACvBC,YAAY,CAACC,OAAb,GAAuB,IAAvB;QACAT,MAAM,CAACU,IAAP,CAAY;UAAEC,IAAI,EAAE;QAAR,CAAZ;MACF,CAHA,MAGO;QACLZ,SAAS,CAAC,MAAD,CAAT;MACF;IACF,CAZA,CAYE,OAAOa,CAAP,EAAU;MACVb,SAAS,CAAC,MAAD,CAAT;IACF;EACD,CAhBD;;EAiBA,OAAO;IACLM,cADK;IAELH,QAFK;IAEKC,QAFL;IAEeC;EAFf,CAAP;AAIF,CA7BA;;AA+BA,MAAMS,cAAa,GAAI,MAAI;EACzB,MAAMb,MAAK,GAAIN,SAAS,EAAxB;;EACA,MAAMoB,UAAS,GAAI,MAAM;IACvBd,MAAM,CAACU,IAAP,CAAY;MAAEC,IAAI,EAAE;IAAR,CAAZ;EACD,CAFD;;EAGA,OAAO;IACLG;EADK,CAAP;AAGF,CARA;;AASA,eAAe;EACbH,IAAI,EAAE,cADO;;EAEbI,KAAK,GAAG;IACN,MAAM;MAAEC,IAAF;MAAQC,QAAR;MAAkBlB;IAAlB,IAAgCF,cAAc,EAApD;IACA,MAAM;MAAEQ,cAAF;MAAkBH,QAAlB;MAA4BC,QAA5B;MAAsCC;IAAtC,IAAoDN,iBAAiB,CAACC,SAAD,CAA3E;IACA,MAAM;MAAEe;IAAF,IAAiBD,cAAc,EAArC;IAEA,OAAO;MACLC,UADK;MAELZ,QAFK;MAEKC,QAFL;MAEeC,SAFf;MAGLC,cAHK;MAILW,IAJK;MAICC;IAJD,CAAP;EAMD,CAbY;;EAcbC,UAAU,EAAE;IAAEtB;EAAF;AAdC,CAAf","names":["reactive","toRefs","useRouter","post","Toast","useToastEffect","useRegisterEffect","showToast","router","data","username","password","password2","handleRegister","result","Error","localStorage","isLogin","push","name","e","useLoginEffect","handleHave","setup","show","toastMsg","components"],"sourceRoot":"","sources":["C:\\Carrie\\VVVVVue\\jingdong\\src\\views\\register\\Register.vue"],"sourcesContent":["<template>\r\n  <div class=\"wrapper\">\r\n    <img src=\"http://www.dell-lee.com/imgs/vue3/user.png\" alt=\"\" />\r\n    <div class=\"wrapper__input\">\r\n      <input v-model=\"username\" type=\"text\" placeholder=\"请输入用户名\" />\r\n    </div>\r\n    <div class=\"wrapper__input\">\r\n      <input v-model=\"password\" type=\"password\" placeholder=\"请输入密码\" />\r\n    </div>\r\n    <div class=\"wrapper__input\">\r\n      <input v-model=\"password2\" type=\"password\" placeholder=\"确认密码\" />\r\n    </div>\r\n    <div @click=\"handleRegister\" class=\"wrapper__register-button\">注册</div>\r\n    <div class=\"wrapper__register-link\" @click=\"handleHave\">已有账号去登录</div>\r\n  </div>\r\n  <Toast v-if=\"show\" :message=\"toastMsg\" />\r\n</template>\r\n\r\n<script>\r\nimport { reactive,toRefs } from \"@vue/reactivity\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { post } from \"@/utils/request\";\r\nimport Toast, { useToastEffect } from \"@/components/Toast.vue\";\r\n\r\n// 将注册的逻辑摘离出来\r\nconst useRegisterEffect = (showToast)=>{\r\n  const router = useRouter();\r\n  const data = reactive({\r\n    username: \"\",\r\n    password: \"\",\r\n    password2: \"\",\r\n  });\r\n  const {username, password, password2} = toRefs(data)\r\n  const handleRegister = async () => {\r\n    try {\r\n      const result = await post(\"/api/user/register\", {\r\n        username: data.username,\r\n        password: data.password,\r\n        password2: data.password2,\r\n      });\r\n      if (result?.Error === 0) {\r\n        localStorage.isLogin = true;\r\n        router.push({ name: \"Home\" });\r\n      } else {\r\n        showToast(\"注册失败\");\r\n      }\r\n    } catch (e) {\r\n      showToast(\"请求失败\");\r\n    }\r\n  };\r\n  return {\r\n    handleRegister,\r\n    username, password, password2\r\n  }\r\n}\r\n\r\nconst useLoginEffect = ()=>{\r\n  const router = useRouter();\r\n  const handleHave = () => {\r\n    router.push({ name: \"Login\" });\r\n  };\r\n  return {\r\n    handleHave\r\n  }\r\n}\r\nexport default {\r\n  name: \"RegisterView\",\r\n  setup() {\r\n    const { show, toastMsg, showToast } = useToastEffect();\r\n    const { handleRegister, username, password, password2 } = useRegisterEffect(showToast)\r\n    const { handleHave } = useLoginEffect()\r\n\r\n    return {\r\n      handleHave,\r\n      username, password, password2,\r\n      handleRegister,\r\n      show, toastMsg,\r\n    };\r\n  },\r\n  components: { Toast },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"../../style/viriables.scss\";\r\n\r\n.wrapper {\r\n  position: absolute;\r\n  top: 50%;\r\n  left: 0;\r\n  right: 0;\r\n  transform: translateY(-50%);\r\n  img {\r\n    display: block;\r\n    margin: 0 auto;\r\n    margin-bottom: 0.4rem;\r\n    height: 0.66rem;\r\n    width: 0.66rem;\r\n  }\r\n  &__input {\r\n    margin: 0 0.4rem 0.16rem 0.4rem;\r\n    padding: 0 0.16rem;\r\n    height: 0.48rem;\r\n    background: #f9f9f9;\r\n    border: 0.01rempx solid rgba(0, 0, 0, 0.1);\r\n    border-radius: 0.06rem;\r\n    color: $content-notice-fontcolor;\r\n    input {\r\n      width: 100%;\r\n      line-height: 0.48rem;\r\n      border: none;\r\n      background: none;\r\n      outline: none;\r\n      font-size: 0.16rem;\r\n      ::placeholder {\r\n        color: $content-notice-fontcolor;\r\n      }\r\n    }\r\n  }\r\n  &__register-button {\r\n    margin: 0.32rem 0.4rem 0.16rem 0.4rem;\r\n    line-height: 0.48rem;\r\n    text-align: center;\r\n    font-size: 0.16rem;\r\n    background: #0091ff;\r\n    color: $bgColor;\r\n    box-shadow: 0 4px 8px 0 rgba(0, 145, 255, 0.32);\r\n    border-radius: 4px;\r\n  }\r\n  &__register-link {\r\n    text-align: center;\r\n    font-size: 0.14rem;\r\n    color: $content-notice-fontcolor;\r\n  }\r\n}\r\n</style>\r\n\r\n"]},"metadata":{},"sourceType":"module"}