{"ast":null,"code":"import Vuex from 'vuex';\n\nconst setLocalCartList = state => {\n  const {\n    cartList\n  } = state;\n  const cartListString = JSON.stringify(cartList);\n  localStorage.cartList = cartListString;\n};\n\nconst getLocalCartList = () => {\n  // cartList的数据结构：{ shopId: { shopName:'', productList: { productId } }}\n  return JSON.parse(localStorage.cartList || {\n    shopId: {\n      shopName: '',\n      productList: {\n        productId\n      }\n    }\n  });\n};\n\nexport default Vuex.createStore({\n  state: {\n    cartList: getLocalCartList()\n  },\n  getters: {},\n  mutations: {\n    // 两个参数，一个是store中的数据state，\n    // 另一个是传过来的数据，用payload表示\n    changeCartItem(state, payload) {\n      // 拿到state，payload之后，\n      // 就需要结合之前的数据结构往里面添加内容\n      const {\n        shopId,\n        productId,\n        productInfo,\n        num\n      } = payload;\n      let shopInfo = state.cartList[shopId];\n\n      if (!shopInfo) {\n        shopInfo = {\n          shopName: '',\n          productList: {}\n        };\n      }\n\n      let product = shopInfo.productList[productId];\n\n      if (!product) {\n        product = productInfo;\n        product.count = 0;\n      }\n\n      product.count = product.count + num; // 只要往购物车中加东西了，商品选中状态就为true\n\n      if (payload.num > 0) {\n        product.check = true;\n      }\n\n      if (product.count < 0) {\n        product.count = 0;\n      }\n\n      shopInfo.productList[productId] = product;\n      state.cartList[shopId] = shopInfo;\n      setLocalCartList(state);\n    },\n\n    changeShopName(state, payload) {\n      const {\n        shopId,\n        shopName\n      } = payload;\n      let shopInfo = state.cartList[shopId];\n\n      if (!shopInfo) {\n        shopInfo = {\n          shopName: '',\n          productList: {}\n        };\n      }\n\n      shopInfo.shopName = shopName;\n      state.cartList[shopId] = shopInfo;\n      setLocalCartList(state);\n    },\n\n    changeCartItemChecked(state, payload) {\n      const {\n        shopId,\n        productId\n      } = payload;\n      let product = state.cartList[shopId].productList[productId];\n      product.check = !product.check;\n      setLocalCartList(state);\n    },\n\n    clearCartProducts(state, payload) {\n      const {\n        shopId\n      } = payload;\n      state.cartList[shopId].productList = {};\n      setLocalCartList(state);\n    },\n\n    allCheckProducts(state, payload) {\n      const {\n        shopId\n      } = payload;\n      const productList = state.cartList[shopId].productList;\n\n      for (let i in productList) {\n        let product = productList[i];\n\n        if (!product.check) {\n          product.check = true;\n        }\n      }\n\n      setLocalCartList(state);\n    }\n\n  },\n  actions: {},\n  modules: {}\n});","map":{"version":3,"names":["Vuex","setLocalCartList","state","cartList","cartListString","JSON","stringify","localStorage","getLocalCartList","parse","shopId","shopName","productList","productId","createStore","getters","mutations","changeCartItem","payload","productInfo","num","shopInfo","product","count","check","changeShopName","changeCartItemChecked","clearCartProducts","allCheckProducts","i","actions","modules"],"sources":["C:/Carrie/VVVVVue/jingdong/src/store/index.js"],"sourcesContent":["import Vuex from 'vuex'\n\nconst setLocalCartList = (state)=>{\n  const {cartList} = state\n  const cartListString = JSON.stringify(cartList)\n  localStorage.cartList = cartListString\n}\n\nconst getLocalCartList = ()=>{\n  // cartList的数据结构：{ shopId: { shopName:'', productList: { productId } }}\n  return JSON.parse(localStorage.cartList || {shopId: { shopName:'', productList: { productId } }})\n}\nexport default Vuex.createStore({\n  state: {\n    cartList: getLocalCartList()\n  },\n  getters: {\n  },\n  mutations: {\n    // 两个参数，一个是store中的数据state，\n    // 另一个是传过来的数据，用payload表示\n    changeCartItem(state, payload) {\n      // 拿到state，payload之后，\n      // 就需要结合之前的数据结构往里面添加内容\n      const { shopId, productId, productInfo, num } = payload\n      let shopInfo = state.cartList[shopId]\n      if(!shopInfo) {\n        shopInfo = { shopName: '', productList: {} }\n      }\n      let product = shopInfo.productList[productId]\n      if(!product) {\n        product = productInfo;\n        product.count = 0\n      }\n      product.count = product.count + num\n      // 只要往购物车中加东西了，商品选中状态就为true\n      if(payload.num > 0) { product.check = true}\n      if(product.count < 0) { product.count = 0}\n      shopInfo.productList[productId] = product\n      state.cartList[shopId] = shopInfo\n\n      setLocalCartList(state)\n    },\n    changeShopName (state, payload) {\n      const { shopId, shopName } = payload\n      let shopInfo = state.cartList[shopId]\n      if(!shopInfo) {\n        shopInfo = { shopName: '', productList: {}}\n      }\n      shopInfo.shopName = shopName\n      state.cartList[shopId] = shopInfo\n\n      setLocalCartList(state)\n    },\n    changeCartItemChecked(state, payload) {\n      const { shopId, productId } = payload\n      let product = state.cartList[shopId].productList[productId]\n      product.check = !product.check\n\n      setLocalCartList(state)\n    },\n    clearCartProducts(state, payload) {\n      const { shopId } = payload\n      state.cartList[shopId].productList = {}\n\n      setLocalCartList(state)\n    },\n    allCheckProducts(state,payload) {\n      const { shopId } = payload\n      const productList = state.cartList[shopId].productList\n      for(let i in productList) {\n        let product = productList[i]\n        if(!product.check){\n          product.check = true\n        }\n      }\n\n      setLocalCartList(state)\n    }\n  },\n  actions: {\n  },\n  modules: {\n  }\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}