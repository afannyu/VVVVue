{"ast":null,"code":"import { useStore } from 'vuex';\nimport { computed } from 'vue'; // 与购物车有关的逻辑\n\nexport const commonCartEffect = shopId => {\n  // 首先将该全局对象取出\n  const store = useStore();\n  const cartList = store.state.cartList;\n\n  const changeCartItem = (shopId, productId, productInfo, num) => {\n    store.commit('changeCartItem', {\n      shopId,\n      productId,\n      productInfo,\n      num\n    });\n  };\n\n  const productList = computed(() => {\n    const productList = cartList[shopId]?.productList || [];\n    return productList;\n  });\n  const shopName = computed(() => {\n    const shopName = cartList[shopId].shopName || '';\n    return shopName;\n  });\n  const caculations = computed(() => {\n    const productList = cartList[shopId]?.productList;\n    let result = {\n      all: 0,\n      price: 0,\n      allCartProducts: true\n    };\n\n    if (productList) {\n      for (let i in productList) {\n        const product = productList[i];\n        result.all += product.count;\n\n        if (product.check) {\n          result.price += product.count * product.price;\n        }\n\n        if (!product.check && product.count > 0) {\n          result.allCartProducts = false;\n        }\n      }\n    }\n\n    result.price = result.price.toFixed(2);\n    return result;\n  });\n  return {\n    changeCartItem,\n    cartList,\n    productList,\n    shopName,\n    caculations\n  };\n};","map":{"version":3,"names":["useStore","computed","commonCartEffect","shopId","store","cartList","state","changeCartItem","productId","productInfo","num","commit","productList","shopName","caculations","result","all","price","allCartProducts","i","product","count","check","toFixed"],"sources":["C:/Carrie/VVVVVue/jingdong/src/effects/cartEffects.js"],"sourcesContent":["import { useStore } from 'vuex'\r\nimport { computed } from 'vue'\r\n\r\n// 与购物车有关的逻辑\r\nexport const commonCartEffect = (shopId)=>{\r\n  // 首先将该全局对象取出\r\n  const store = useStore()\r\n  const cartList = store.state.cartList\r\n  const changeCartItem = (shopId, productId, productInfo, num)=>{\r\n    store.commit('changeCartItem',{\r\n      shopId, productId, productInfo, num\r\n    })\r\n  }\r\n  const productList = computed(()=>{\r\n    const productList = cartList[shopId]?.productList || []\r\n    return productList\r\n  })\r\n  const shopName = computed(()=>{\r\n    const shopName = cartList[shopId].shopName || ''\r\n    return shopName\r\n  })\r\n  const caculations = computed(()=>{\r\n    const productList = cartList[shopId]?.productList\r\n    let result = { all: 0, price: 0, allCartProducts: true }\r\n    if(productList) {\r\n      for(let i in productList) {\r\n        const product = productList[i]\r\n        result.all += product.count\r\n        if(product.check) {\r\n          result.price += (product.count * product.price)\r\n        }\r\n        if(!product.check && product.count > 0){\r\n          result.allCartProducts = false\r\n        }\r\n      }\r\n    }\r\n    result.price = result.price.toFixed(2)\r\n    return result\r\n  })\r\n  return {\r\n    changeCartItem, cartList, productList, shopName, caculations\r\n  }\r\n}\r\n"],"mappings":"AAAA,SAASA,QAAT,QAAyB,MAAzB;AACA,SAASC,QAAT,QAAyB,KAAzB,C,CAEA;;AACA,OAAO,MAAMC,gBAAgB,GAAIC,MAAD,IAAU;EACxC;EACA,MAAMC,KAAK,GAAGJ,QAAQ,EAAtB;EACA,MAAMK,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYD,QAA7B;;EACA,MAAME,cAAc,GAAG,CAACJ,MAAD,EAASK,SAAT,EAAoBC,WAApB,EAAiCC,GAAjC,KAAuC;IAC5DN,KAAK,CAACO,MAAN,CAAa,gBAAb,EAA8B;MAC5BR,MAD4B;MACpBK,SADoB;MACTC,WADS;MACIC;IADJ,CAA9B;EAGD,CAJD;;EAKA,MAAME,WAAW,GAAGX,QAAQ,CAAC,MAAI;IAC/B,MAAMW,WAAW,GAAGP,QAAQ,CAACF,MAAD,CAAR,EAAkBS,WAAlB,IAAiC,EAArD;IACA,OAAOA,WAAP;EACD,CAH2B,CAA5B;EAIA,MAAMC,QAAQ,GAAGZ,QAAQ,CAAC,MAAI;IAC5B,MAAMY,QAAQ,GAAGR,QAAQ,CAACF,MAAD,CAAR,CAAiBU,QAAjB,IAA6B,EAA9C;IACA,OAAOA,QAAP;EACD,CAHwB,CAAzB;EAIA,MAAMC,WAAW,GAAGb,QAAQ,CAAC,MAAI;IAC/B,MAAMW,WAAW,GAAGP,QAAQ,CAACF,MAAD,CAAR,EAAkBS,WAAtC;IACA,IAAIG,MAAM,GAAG;MAAEC,GAAG,EAAE,CAAP;MAAUC,KAAK,EAAE,CAAjB;MAAoBC,eAAe,EAAE;IAArC,CAAb;;IACA,IAAGN,WAAH,EAAgB;MACd,KAAI,IAAIO,CAAR,IAAaP,WAAb,EAA0B;QACxB,MAAMQ,OAAO,GAAGR,WAAW,CAACO,CAAD,CAA3B;QACAJ,MAAM,CAACC,GAAP,IAAcI,OAAO,CAACC,KAAtB;;QACA,IAAGD,OAAO,CAACE,KAAX,EAAkB;UAChBP,MAAM,CAACE,KAAP,IAAiBG,OAAO,CAACC,KAAR,GAAgBD,OAAO,CAACH,KAAzC;QACD;;QACD,IAAG,CAACG,OAAO,CAACE,KAAT,IAAkBF,OAAO,CAACC,KAAR,GAAgB,CAArC,EAAuC;UACrCN,MAAM,CAACG,eAAP,GAAyB,KAAzB;QACD;MACF;IACF;;IACDH,MAAM,CAACE,KAAP,GAAeF,MAAM,CAACE,KAAP,CAAaM,OAAb,CAAqB,CAArB,CAAf;IACA,OAAOR,MAAP;EACD,CAjB2B,CAA5B;EAkBA,OAAO;IACLR,cADK;IACWF,QADX;IACqBO,WADrB;IACkCC,QADlC;IAC4CC;EAD5C,CAAP;AAGD,CAtCM"},"metadata":{},"sourceType":"module"}