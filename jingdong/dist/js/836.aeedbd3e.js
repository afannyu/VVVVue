"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[836],{3229:function(t,c,a){a.d(c,{E:function(){return s}});var n=a(3907),e=a(6252);const s=t=>{const c=(0,n.oR)(),a=c.state.cartList,s=(t,a,n,e)=>{c.commit("changeCartItem",{shopId:t,productId:a,productInfo:n,num:e})},r=(0,e.Fl)((()=>{const c=a[t]?.productList||[];return c})),o=(0,e.Fl)((()=>{const c=a[t].shopName||"";return c})),i=(0,e.Fl)((()=>{const c=a[t]?.productList;let n={all:0,price:0,allCartProducts:!0};if(c)for(let t in c){const a=c[t];n.all+=a.count,a.check&&(n.price+=a.count*a.price),!a.check&&a.count>0&&(n.allCartProducts=!1)}return n.price=n.price.toFixed(2),n}));return{changeCartItem:s,cartList:a,productList:r,shopName:o,caculations:i}}},8215:function(t,c,a){a.d(c,{e:function(){return e}});var n=a(2201);const e=()=>{const t=(0,n.tv)(),c=()=>{t.back()};return{handleClickBack:c}}},836:function(t,c,a){a.r(c),a.d(c,{default:function(){return $}});var n=a(6252);const e={class:"wrapper"};function s(t,c,a,s,r,o){const i=(0,n.up)("TopArae"),d=(0,n.up)("ProductList"),l=(0,n.up)("Bottom");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",e,[(0,n.Wm)(i),(0,n.Wm)(d)]),(0,n.Wm)(l)],64)}const r={class:"top"},o={class:"top__order"},i=(0,n.Uk)(" 确认订单 "),d=(0,n.uE)('<div class="top__receiver" data-v-1f6771a1><h4 class="top__receiver__title" data-v-1f6771a1>收货地址</h4><div class="top__receiver__address" data-v-1f6771a1>北京理工大学国防科技园2号楼10层</div><div class="top__receiver__icon iconfont" data-v-1f6771a1></div><div class="top__receiver__info" data-v-1f6771a1><span class="info" data-v-1f6771a1>瑶妹（先生）</span><span class="phone" data-v-1f6771a1>11722648122</span></div></div>',1);function l(t,c,a,e,s,l){return(0,n.wg)(),(0,n.iD)("div",r,[(0,n._)("div",o,[(0,n._)("div",{onClick:c[0]||(c[0]=(...t)=>e.handleClickBack&&e.handleClickBack(...t)),class:"iconfont top__order__icon"},""),i]),d])}var u=a(8215),_={name:"TopAreaView",setup(){const{handleClickBack:t}=(0,u.e)();return{handleClickBack:t}}},p=a(3744);const v=(0,p.Z)(_,[["render",l],["__scopeId","data-v-1f6771a1"]]);var m=v,h=a(3577);const k={class:"products"},f={class:"product"},C={key:0,class:"product__item"},w=["src"],g={class:"product__item__text"},I={class:"title"},L={class:"price"},B={class:"yen"},b={class:"origin"};function y(t,c,a,e,s,r){return(0,n.wg)(),(0,n.iD)("div",k,[(0,n._)("div",f,[(0,n._)("h4",null,(0,h.zw)(e.shopName),1),((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.productList,(t=>((0,n.wg)(),(0,n.iD)(n.HY,{key:t._id},[t.count>0?((0,n.wg)(),(0,n.iD)("div",C,[(0,n._)("img",{src:t.imgUrl,alt:""},null,8,w),(0,n._)("div",g,[(0,n._)("div",I,(0,h.zw)(t.name),1),(0,n._)("div",L,[(0,n._)("span",B,"￥"+(0,h.zw)(t.price)+" × "+(0,h.zw)(t.count),1),(0,n._)("span",b,(0,h.zw)((t.price*t.count).toFixed(2)),1)])])])):(0,n.kq)("",!0)],64)))),128))])])}var D=a(3229),N=a(2201),O={name:"ProductListView",setup(){const t=(0,N.yj)(),c=t.params.id,{productList:a,shopName:n}=(0,D.E)(c);return{productList:a,shopName:n}}};const z=(0,p.Z)(O,[["render",y],["__scopeId","data-v-7496f4b2"]]);var F=z,P=a(9963);const H=t=>((0,n.dD)("data-v-6ace9d56"),t=t(),(0,n.Cn)(),t),Z={class:"order"},j={class:"order__price"},E=(0,n.Uk)("实付金额："),V={class:"mask"},Y={class:"mask__content"},x=H((()=>(0,n._)("h3",null,"确认要离开收银台？",-1))),A=H((()=>(0,n._)("div",{class:"mask__content__desc"},"请尽快完成支付，否则将被取消",-1))),T={class:"mask__content__btns"};function U(t,c,a,e,s,r){return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",Z,[(0,n._)("div",j,[E,(0,n._)("b",null,"￥"+(0,h.zw)(e.caculations.price),1)]),(0,n._)("div",{onClick:c[0]||(c[0]=(...t)=>e.handleOrderClick&&e.handleOrderClick(...t)),class:"order__order"},"提交订单")]),(0,n.wy)((0,n._)("div",V,[(0,n._)("div",Y,[x,A,(0,n._)("div",T,[(0,n._)("div",{onClick:c[1]||(c[1]=()=>e.handleComfirmClick(!0)),class:"mask__content__btn"},"取消订单"),(0,n._)("div",{onClick:c[2]||(c[2]=()=>e.handleComfirmClick(!1)),class:"mask__content__btn"},"确认支付")])])],512),[[P.F8,e.showBtn]])],64)}var W=a(2262),R=a(4471),q=a(1120),K=a(3907);const G=(t,c,a)=>{const n=(0,K.oR)(),e=(0,W.iH)(!1),s=()=>{e.value=!e.value},r=async e=>{const s=[];for(let t in a.value){let c=a.value[t];s.push({id:parseInt(c._id,10),num:c.count}),console.log(c)}try{const a=await(0,R.v)("/api/order",{addressId:1,shopId:parseInt(t,10),shopName:c.value,isCanceled:e,products:s});0===a?.errno&&(n.commit("clearCartProducts",{shopId:t}),q.Z.push({name:"OrderList"}))}catch(r){console.log("请求失败")}};return{handleComfirmClick:r,showBtn:e,handleOrderClick:s}};var J={name:"BottomView",setup(){const t=(0,N.yj)(),c=t.params.id,{caculations:a,shopName:n,productList:e}=(0,D.E)(c),{handleComfirmClick:s,showBtn:r,handleOrderClick:o}=G(c,n,e);return{caculations:a,handleComfirmClick:s,showBtn:r,handleOrderClick:o}}};const M=(0,p.Z)(J,[["render",U],["__scopeId","data-v-6ace9d56"]]);var Q=M,S={name:"OrderView",components:{TopArae:m,ProductList:F,Bottom:Q}};const X=(0,p.Z)(S,[["render",s],["__scopeId","data-v-3e666b16"]]);var $=X}}]);
//# sourceMappingURL=836.aeedbd3e.js.map